<map version="0.8.0">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1133913975396" ID="Freemind_Link_784585536" MODIFIED="1133959040234" TEXT="Malware Analysis">
<node CREATED="1133914095111" ID="Freemind_Link_120051461" MODIFIED="1133958916937" POSITION="right" TEXT="Trivial Analysis">
<node CREATED="1133914113672" ID="Freemind_Link_293574991" MODIFIED="1133914174797" TEXT="Imports"/>
<node CREATED="1133914179003" ID="Freemind_Link_1978511041" MODIFIED="1133914179722" TEXT="Strings"/>
</node>
<node CREATED="1133914065261" ID="_" MODIFIED="1133958919375" POSITION="right" TEXT="Live Analysis">
<node CREATED="1133914069170" ID="Freemind_Link_1108508052" MODIFIED="1133914071390" TEXT="Regmon"/>
<node CREATED="1133914071609" ID="Freemind_Link_954707512" MODIFIED="1133914072516" TEXT="Filemon"/>
<node CREATED="1133914072954" ID="Freemind_Link_208555498" MODIFIED="1133914075816" TEXT="TCPView"/>
<node CREATED="1133961058109" ID="Freemind_Link_971819645" MODIFIED="1133961059953" TEXT="InCtrl"/>
<node CREATED="1133961060203" ID="Freemind_Link_1779551267" MODIFIED="1133961063890" TEXT="SysAnalyzer"/>
<node CREATED="1133914076269" ID="Freemind_Link_1309554715" MODIFIED="1133914077692" TEXT="Etc..."/>
</node>
<node CREATED="1133958857187" ID="Freemind_Link_144314518" MODIFIED="1133958866078" POSITION="right" TEXT="Unpacking">
<node CREATED="1133958928828" ID="Freemind_Link_1515228727" MODIFIED="1133958933281" TEXT="Dumping">
<node CREATED="1133959045031" ID="Freemind_Link_1944318244" MODIFIED="1133959046843" TEXT="OllyDump">
<node CREATED="1133960879125" ID="Freemind_Link_85135998" MODIFIED="1133960927312" TEXT="Execute the target process in OllyDbg"/>
<node CREATED="1133960882390" ID="Freemind_Link_343042741" MODIFIED="1133960939734" TEXT="Either single step to the control transfer or simply let the application run"/>
<node CREATED="1133960940953" ID="Freemind_Link_599163846" MODIFIED="1133960946843" TEXT="Select OllyDump from the plugins menu"/>
<node CREATED="1133960947046" ID="Freemind_Link_1776107645" MODIFIED="1133960949484" TEXT="Select dump"/>
<node CREATED="1133960949718" ID="Freemind_Link_685943831" MODIFIED="1133960960000" TEXT="Optionally select one of two IAT rebuilding methods"/>
<node CREATED="1133960983734" ID="Freemind_Link_137903391" MODIFIED="1133960991687" TEXT="Look into rebuilding the IAT if you did not select a rebuild method"/>
</node>
<node CREATED="1133959066828" ID="Freemind_Link_1163924955" MODIFIED="1133959074140" TEXT="ProcDump">
<node CREATED="1133960961171" ID="Freemind_Link_857494284" MODIFIED="1133960965296" TEXT="Launch the target process on it&apos;s own"/>
<node CREATED="1133960965515" ID="Freemind_Link_1407840363" MODIFIED="1133960975656" TEXT="Have ProcDump create a dump"/>
<node CREATED="1133960975828" ID="Freemind_Link_410209476" MODIFIED="1133960981875" TEXT="Look into rebuilding the IAT"/>
</node>
<node CREATED="1133959075734" ID="Freemind_Link_743504936" MODIFIED="1133959076906" TEXT="Etc."/>
</node>
<node CREATED="1133958933593" ID="Freemind_Link_743689329" MODIFIED="1133958952234" TEXT="IAT Fixing / Symbol Creation">
<node CREATED="1133959078390" ID="Freemind_Link_425036619" MODIFIED="1133959081781" TEXT="OllyDump">
<node CREATED="1133960542109" ID="Freemind_Link_813087544" MODIFIED="1133960930328" TEXT="Execute the target process in OllyDbg"/>
<node CREATED="1133960548437" ID="Freemind_Link_784942039" MODIFIED="1133960570843" TEXT="Either single step to the control transfer or simply let the application run"/>
<node CREATED="1133960571234" ID="Freemind_Link_1775776962" MODIFIED="1133960580843" TEXT="Select OllyDump from the plugins menu"/>
<node CREATED="1133960581218" ID="Freemind_Link_1513725364" MODIFIED="1133960584453" TEXT="Select dump"/>
<node CREATED="1133960584781" ID="Freemind_Link_1221583717" MODIFIED="1133960865093" TEXT="Select one of two IAT rebuild methods"/>
<node CREATED="1133960869265" ID="Freemind_Link_1581255287" MODIFIED="1133960871296" TEXT="Load dump in IDA"/>
</node>
<node CREATED="1133959081968" ID="Freemind_Link_609749274" MODIFIED="1133959084765" TEXT="ImportRec">
<node CREATED="1133960256078" ID="Freemind_Link_1768005461" MODIFIED="1133960270218" TEXT="Create a dump file"/>
<node CREATED="1133960417859" ID="Freemind_Link_1366424569" MODIFIED="1133960425312" TEXT="Launch the process on it&apos;s own and let it run"/>
<node CREATED="1133960425734" ID="Freemind_Link_865381833" MODIFIED="1133960430593" TEXT="Launch ImportRec"/>
<node CREATED="1133960430843" ID="Freemind_Link_1828317133" MODIFIED="1133960433671" TEXT="Select the target process"/>
<node CREATED="1133960434078" ID="Freemind_Link_291520899" MODIFIED="1133960438765" TEXT="Press &quot;IAT Autoscan&quot;"/>
<node CREATED="1133960438968" ID="Freemind_Link_323703613" MODIFIED="1133960476578" TEXT="If nothing was found, increase the size and search again"/>
<node CREATED="1133960476890" ID="Freemind_Link_1009809400" MODIFIED="1133960482578" TEXT="Manually remove garbage thunks"/>
<node CREATED="1133960483140" ID="Freemind_Link_1350824219" MODIFIED="1133960488906" TEXT="Press &quot;fix dump&quot;"/>
<node CREATED="1133960489500" ID="Freemind_Link_707311234" MODIFIED="1133960493390" TEXT="Select the target dump"/>
<node CREATED="1133960507187" ID="Freemind_Link_868453839" MODIFIED="1133960510687" TEXT="Load in IDA to verify results"/>
</node>
<node CREATED="1133959085109" ID="Freemind_Link_224281692" MODIFIED="1133959095890" TEXT="IDCDumpFix">
<node CREATED="1133960260281" ID="Freemind_Link_1134524466" MODIFIED="1133960263343" TEXT="Create a dump file"/>
<node CREATED="1133959103390" ID="Freemind_Link_311983482" MODIFIED="1133959471234" TEXT="Start target application in OllyDbg"/>
<node CREATED="1133959471453" ID="Freemind_Link_769132296" MODIFIED="1133959475296" TEXT="Press F9 to let it run"/>
<node CREATED="1133959475609" ID="Freemind_Link_76403406" MODIFIED="1133959525828" TEXT="Press Alt+M and locate the code page"/>
<node CREATED="1133959526578" ID="Freemind_Link_917345060" MODIFIED="1133959529203" TEXT="Follow in disassembler"/>
<node CREATED="1133959530000" ID="Freemind_Link_896831733" MODIFIED="1133959534312" TEXT="Alt+A to analyze"/>
<node CREATED="1133959534531" ID="Freemind_Link_1599250220" MODIFIED="1133959543937" TEXT="Right click and select Search -&gt; all intermodular calls"/>
<node CREATED="1133959544578" ID="Freemind_Link_494057615" MODIFIED="1133959553578" TEXT="Copy paste the entire table to IDCDumpFix"/>
<node CREATED="1133960231484" ID="Freemind_Link_336820083" MODIFIED="1133960243078" TEXT="Convert to IDC"/>
<node CREATED="1133960243765" ID="Freemind_Link_1118341969" MODIFIED="1133960253718" TEXT="Run in IDA over dumped file"/>
<node CREATED="1133960517843" ID="Freemind_Link_1937506377" MODIFIED="1133960530078" TEXT="You won&apos;t get an IAT using this technique, but you will get usable symbols"/>
<node CREATED="1133960530500" ID="Freemind_Link_1557459395" MODIFIED="1133960539968" TEXT="(watch for an increase in the &quot;names&quot; list)"/>
</node>
</node>
<node CREATED="1133958936984" ID="Freemind_Link_732818757" MODIFIED="1133958969484" TEXT="Emulation">
<node CREATED="1133960995515" ID="Freemind_Link_1878999289" MODIFIED="1133960999218" TEXT="Load target in IDA"/>
<node CREATED="1133960999640" ID="Freemind_Link_1629921537" MODIFIED="1133961009890" TEXT="Launch IDA-x86-emu plug-in"/>
<node CREATED="1133961010468" ID="Freemind_Link_1689411703" MODIFIED="1133961021843" TEXT="Click &quot;push data&quot;"/>
<node CREATED="1133961022171" ID="Freemind_Link_132498545" MODIFIED="1133961037250" TEXT="Enter &quot;0 0 0 0 0 0 0 ....&quot; to create some stack space"/>
<node CREATED="1133961037546" ID="Freemind_Link_711037703" MODIFIED="1133961042171" TEXT="Copy the value of ESP to EBP"/>
<node CREATED="1133961042515" ID="Freemind_Link_1667182712" MODIFIED="1133961049718" TEXT="You are now ready to start using the plug-in"/>
</node>
</node>
<node CREATED="1133914256984" ID="Freemind_Link_884807113" MODIFIED="1133958922515" POSITION="right" TEXT="Reverse Engineering">
<node CREATED="1133914266960" ID="Freemind_Link_7871855" MODIFIED="1133914410850" TEXT="Identify if malware is a variant"/>
<node CREATED="1133914275591" ID="Freemind_Link_1326032491" MODIFIED="1133914279579" TEXT="Call graph + naming analysis"/>
<node CREATED="1133914280001" ID="Freemind_Link_475588665" MODIFIED="1133993676078" TEXT="Quickly scan through binary naming obvious functions"/>
<node CREATED="1133993676515" ID="Freemind_Link_56619076" MODIFIED="1133993686531" TEXT="Utilize the keyboard shortcuts to speed the process"/>
<node CREATED="1133993687015" ID="Freemind_Link_1910046136" MODIFIED="1133993706593" TEXT="The custom tagging routines we created are helpful"/>
<node CREATED="1133914379904" ID="Freemind_Link_1265040300" MODIFIED="1133914388864" TEXT="String decoding if necessary"/>
<node CREATED="1134028692484" ID="Freemind_Link_1237534968" MODIFIED="1134028701843" TEXT="Back trace interesting string and API cross references"/>
<node CREATED="1133914296904" ID="Freemind_Link_1824062560" MODIFIED="1133914307616" TEXT="Look for answers to specific questions">
<node CREATED="1133914308726" ID="Freemind_Link_1973401872" MODIFIED="1133914312776" TEXT="How is it spreading?">
<node CREATED="1133914436650" ID="Freemind_Link_1495459075" MODIFIED="1133914447362" TEXT="If over IP how fast?">
<node CREATED="1133914595301" ID="Freemind_Link_1460862478" MODIFIED="1133914600837" TEXT="connect()"/>
<node CREATED="1133914656582" ID="Freemind_Link_372477968" MODIFIED="1133914658193" TEXT="send()"/>
<node CREATED="1133914667340" ID="Freemind_Link_1998684136" MODIFIED="1133914668966" TEXT="sendto()"/>
<node CREATED="1133914660632" ID="Freemind_Link_857342490" MODIFIED="1133914664197" TEXT="CreateThread()"/>
<node CREATED="1133914675940" ID="Freemind_Link_1192735322" MODIFIED="1133914677973" TEXT="Sleep()"/>
</node>
<node CREATED="1133914447581" ID="Freemind_Link_1489294312" MODIFIED="1133914455383" TEXT="Is the prand() biased?">
<node CREATED="1133914957215" ID="Freemind_Link_1948539466" MODIFIED="1133914959670" TEXT="GetTickCount()"/>
<node CREATED="1133914976073" ID="Freemind_Link_845420634" MODIFIED="1133914979091" TEXT="rand() ;-)"/>
</node>
<node CREATED="1133914455602" ID="Freemind_Link_1057269185" MODIFIED="1133914459996" TEXT="Does it contain a mass mailer?">
<node CREATED="1133914690545" ID="Freemind_Link_286616849" MODIFIED="1133914694329" TEXT="harvesting e-mails">
<node CREATED="1133914695002" ID="Freemind_Link_652923714" MODIFIED="1133914712374" TEXT="FindFirstFile()"/>
<node CREATED="1133914712796" ID="Freemind_Link_41011066" MODIFIED="1133914715017" TEXT="FindNextFile()"/>
<node CREATED="1133914722976" ID="Freemind_Link_563020926" MODIFIED="1133914726838" TEXT="MapViewOfFile()"/>
<node CREATED="1133914727104" ID="Freemind_Link_271123984" MODIFIED="1133914749637" TEXT="CreateFile()"/>
<node CREATED="1133914753436" ID="Freemind_Link_1271309092" MODIFIED="1133914757095" TEXT="CreateFileMapping()"/>
</node>
<node CREATED="1133914764116" ID="Freemind_Link_1949824749" MODIFIED="1133914778393" TEXT="SMTP engine">
<node CREATED="1133914922720" ID="Freemind_Link_1773818369" MODIFIED="1133914945472" TEXT="htons(25) / htons(0x19)"/>
</node>
<node CREATED="1133914778580" ID="Freemind_Link_1634514513" MODIFIED="1133914783662" TEXT="SMTP discovery">
<node CREATED="1133914851417" ID="Freemind_Link_1841780460" MODIFIED="1133915183667" TEXT="RegQueryValue(Software\Microsoft\Internet Account Manager\Accounts\SMTP Server)"/>
</node>
</node>
<node CREATED="1133914461998" ID="Freemind_Link_542241846" MODIFIED="1133914465375" TEXT="Does it spread over network shares?">
<node CREATED="1133915054883" ID="Freemind_Link_1508312601" MODIFIED="1133915056759" TEXT="WNetOpenEnum()"/>
<node CREATED="1133915064734" ID="Freemind_Link_1064609032" MODIFIED="1133915066219" TEXT="WNetEnumResource()"/>
<node CREATED="1133915066626" ID="Freemind_Link_1218075451" MODIFIED="1133915066626" TEXT=""/>
</node>
<node CREATED="1133914465563" ID="Freemind_Link_1227175170" MODIFIED="1133914476493" TEXT="Does it spread over P2P?">
<node CREATED="1133914787759" ID="Freemind_Link_1185466205" MODIFIED="1133914789448" TEXT="kazaa">
<node CREATED="1133914790167" ID="Freemind_Link_1372261374" MODIFIED="1133915174739" TEXT="RegQueryValue(Software\\Kazaa\\Transfer)"/>
</node>
</node>
<node CREATED="1133914476900" ID="Freemind_Link_284901600" MODIFIED="1133914481637" TEXT="Does it spread over an exploit?">
<node CREATED="1133915264541" ID="Freemind_Link_866466139" MODIFIED="1133915266964" TEXT="connect()"/>
<node CREATED="1133915269138" ID="Freemind_Link_1833298357" MODIFIED="1133915270483" TEXT="send()"/>
<node CREATED="1133915270921" ID="Freemind_Link_1148335906" MODIFIED="1133915272531" TEXT="sendto()"/>
</node>
</node>
<node CREATED="1133914312979" ID="Freemind_Link_1071341810" MODIFIED="1133914318436" TEXT="Does it contain a backdoor?">
<node CREATED="1133914483748" ID="Freemind_Link_1550819955" MODIFIED="1133914494100" TEXT="Does it connect to an IRC server?"/>
<node CREATED="1133914494366" ID="Freemind_Link_55349056" MODIFIED="1133914498994" TEXT="Does it bind to any ports?">
<node CREATED="1133915240851" ID="Freemind_Link_1091568939" MODIFIED="1133915242462" TEXT="bind()"/>
<node CREATED="1133915242681" ID="Freemind_Link_294550074" MODIFIED="1133915244870" TEXT="accept()"/>
<node CREATED="1133915245151" ID="Freemind_Link_1864069768" MODIFIED="1133915246809" TEXT="listen()"/>
</node>
</node>
<node CREATED="1133914422984" ID="Freemind_Link_1768726859" MODIFIED="1133914426518" TEXT="What modifications are made?">
<node CREATED="1133914503951" ID="Freemind_Link_76220333" MODIFIED="1133914516898" TEXT="Does it touch any registery keys?">
<node CREATED="1133915141573" ID="Freemind_Link_1288362292" MODIFIED="1133915144638" TEXT="RegOpenKey()"/>
<node CREATED="1133915144966" ID="Freemind_Link_1926134339" MODIFIED="1133915147609" TEXT="RegCreateKey()"/>
<node CREATED="1133915147984" ID="Freemind_Link_1098894841" MODIFIED="1133915156100" TEXT="RegSetValue()"/>
</node>
<node CREATED="1133914517133" ID="Freemind_Link_1761939962" MODIFIED="1133914519494" TEXT="Does it touch any files?"/>
<node CREATED="1133914519682" ID="Freemind_Link_1887770049" MODIFIED="1133914523747" TEXT="Does it touch any processes?">
<node CREATED="1133915191533" ID="Freemind_Link_73435116" MODIFIED="1133915195317" TEXT="OpenProcess()"/>
<node CREATED="1133915230140" ID="Freemind_Link_1586644217" MODIFIED="1133915233001" TEXT="WriteProcessMemory()"/>
<node CREATED="1133915209953" ID="Freemind_Link_1323420248" MODIFIED="1133915212564" TEXT="CreateRemoteThread()"/>
</node>
<node CREATED="1133914524373" ID="Freemind_Link_1099369149" MODIFIED="1133914527782" TEXT="Does it touch itself? (hehe)"/>
</node>
<node CREATED="1133914426862" ID="Freemind_Link_1846042774" MODIFIED="1133914431350" TEXT="Are there any special dates?">
<node CREATED="1133914536773" ID="Freemind_Link_1558441251" MODIFIED="1133914554927" TEXT="Is there an expiration date?">
<node CREATED="1133915020247" ID="Freemind_Link_1353359772" MODIFIED="1133915022546" TEXT="GetSystemTimeAsFileTime()"/>
<node CREATED="1133915103576" ID="Freemind_Link_227925163" MODIFIED="1133915109267" TEXT="SystemTimeToFileTime()"/>
<node CREATED="1133915124982" ID="Freemind_Link_1004750028" MODIFIED="1133915129220" TEXT="FileTimeToLocalFileTime()"/>
</node>
<node CREATED="1133914540619" ID="Freemind_Link_926101616" MODIFIED="1133914548516" TEXT="Is there a destruction date?"/>
</node>
</node>
<node CREATED="1133958936984" ID="Freemind_Link_1989637192" MODIFIED="1133958969484" TEXT="Emulation">
<node CREATED="1133960995515" ID="Freemind_Link_246192765" MODIFIED="1133960999218" TEXT="Load target in IDA"/>
<node CREATED="1133960999640" ID="Freemind_Link_1000353248" MODIFIED="1133961009890" TEXT="Launch IDA-x86-emu plug-in"/>
<node CREATED="1133961010468" ID="Freemind_Link_983939993" MODIFIED="1133961021843" TEXT="Click &quot;push data&quot;"/>
<node CREATED="1133961022171" ID="Freemind_Link_710833952" MODIFIED="1133961037250" TEXT="Enter &quot;0 0 0 0 0 0 0 ....&quot; to create some stack space"/>
<node CREATED="1133961037546" ID="Freemind_Link_953969693" MODIFIED="1133961042171" TEXT="Copy the value of ESP to EBP"/>
<node CREATED="1133961042515" ID="Freemind_Link_1555355141" MODIFIED="1133961049718" TEXT="You are now ready to start using the plug-in"/>
</node>
</node>
</node>
</map>
